<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="es">
<head th:replace="fragments/common-head :: common-head">
</head>
<body>
<h1>Listado de comandas</h1>
<div th:replace="fragments/navbar :: navbar"></div>
<form action="#" th:action="@{/comanda/add}" th:object="${comanda}" method="post">
    <div class="form-group">
        <label for="mesa">Mesa</label>
        <select id="mesa" th:field="*{mesa.id}" class="form-control">
            <option th:each="mesa : ${mesas}" th:value="${mesa.id}" th:text="${mesa.id + ' - ' + mesa.locationUrl + ' - ' + mesa.numComensales}"></option>
        </select>
    </div>
    <div class="form-group">
        <label for="camarero">Camarero</label>
        <select id="camarero" th:field="*{idCamarero.id}" class="form-control">
            <option th:each="camarero : ${users}" th:value="${camarero.id}" th:text="${camarero.userName + ' - ' + camarero.id}"></option>
        </select>
    </div>

    <div class="form-group">
        <label for="numComensales">Número de comensales</label>
        <input type="number" id="numComensales" th:field="*{numComensales}" class="form-control" />
    </div>
    <!-- Here you may want to add more fields for other properties of Comanda -->
    <button type="submit" class="btn btn-primary">Guardar Comanda</button>
</form>
<br>
<h2>Añadir Lineas de Comanda</h2>
<div id="lineaComandaContainer">
    <!-- JavaScript will append forms here -->
</div>
<button type="button" id="addLineaComandaButton" class="btn btn-primary">Añadir Linea de Comanda</button>

<style>
    .form-row {
        display: flex;
        gap: 10px;
        align-items: center;
        margin-bottom: 10px;
    }

    .form-row div {
        flex: 1;
    }
</style>

<script>
    document.getElementById("addLineaComandaButton").addEventListener("click", function () {
        var container = document.getElementById("lineaComandaContainer");

        // Create a new form and append it to the container
        var form = document.createElement("form");
        form.action = "/lineaComanda/add";
        form.method = "post";
        form.className = "form-row";

        // Add the fields to the form
        var fields = ["concepto", "descripcion", "estado", "importe", "iva", "total", "producto", "usuario"];
        fields.forEach(function (field) {
            var div = document.createElement("div");

            var label = document.createElement("label");
            label.for = field;
            label.textContent = field.charAt(0).toUpperCase() + field.slice(1);
            div.appendChild(label);

            var input;
            if (field === "producto" || field === "usuario") {
                input = document.createElement("select");
                // You'll need to populate these select options with data from your server
                input.className = "form-control";
            } else {
                input = document.createElement("input");
                if (field === "importe" || field === "iva" || field === "total") {
                    input.type = "number";
                } else {
                    input.type = "text";
                }
                input.className = "form-control";
            }
            input.id = field;
            input.name = field;
            div.appendChild(input);

            form.appendChild(div);
        });
        // Add a submit button to the form
        var submitButton = document.createElement("button");
                submitButton.type = "submit";
                submitButton.textContent = "Guardar";
                submitButton.className = "btn btn-primary";
                form.appendChild(submitButton);

        container.appendChild(form);
        // Add a delete button to the form
        var deleteButton = document.createElement("button");
        deleteButton.type = "button";
        deleteButton.textContent = "Eliminar";
        deleteButton.className = "btn btn-danger";
        deleteButton.addEventListener("click", function () {
            container.removeChild(form);
        });
        form.appendChild(deleteButton);
    });
</script>

<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>
</html>

</html>
